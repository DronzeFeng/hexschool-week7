"use strict";(self["webpackChunkweek7"]=self["webpackChunkweek7"]||[]).push([[945],{2945:function(t,e,l){l.r(e),l.d(e,{default:function(){return mt}});var a=l(3396),d=l(7139),i=l(9242);const s={id:"app"},r={class:"container"},n={class:"table mt-4"},o=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"120"},"購買時間"),(0,a._)("th",{width:"120"},"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",{width:"120"},"應付金額"),(0,a._)("th",{width:"100"},"是否付款"),(0,a._)("th",{width:"120"},"編輯")])],-1),u=["textContent"],c={class:"list-unstyled"},p={class:"text-right"},h={class:"form-check form-switch"},_=["id","onUpdate:modelValue","onChange"],m=["for"],g={key:0},w={key:1},b={class:"btn-group"},y=["onClick"],f=["onClick"];function k(t,e,l,k,D,O){const v=(0,a.up)("AdminLoading"),M=(0,a.up)("AdminPagination"),$=(0,a.up)("OrderModal"),x=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",r,[(0,a.Wm)(v,{active:D.isLoading,"z-index":1060},null,8,["active"]),(0,a._)("table",n,[o,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(D.orders,(e=>((0,a.wg)(),(0,a.iD)(a.HY,{key:e.id},[D.orders.length?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,d.C_)({"text-secondary":!e.is_paid})},[(0,a._)("td",null,(0,d.zw)(t.$filters.date(e.create_at)),1),(0,a._)("td",null,[e.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,d.zw)(e.user.email)},null,8,u)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.products,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id},(0,d.zw)(t.product.title)+" 數量："+(0,d.zw)(t.qty)+" "+(0,d.zw)(t.product.unit),1)))),128))])]),(0,a._)("td",p,(0,d.zw)(e.total),1),(0,a._)("td",null,[(0,a._)("div",h,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${e.id}`,"onUpdate:modelValue":t=>e.is_paid=t,onChange:t=>O.updatePaid(e)},null,40,_),[[i.e8,e.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${e.id}`},[e.is_paid?((0,a.wg)(),(0,a.iD)("span",g,"已付款")):((0,a.wg)(),(0,a.iD)("span",w,"未付款"))],8,m)])]),(0,a._)("td",null,[(0,a._)("div",b,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:t=>O.openModal("edit",e)},"檢視",8,y),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:t=>O.openModal("delete",e)},"刪除",8,f)])])],2)):(0,a.kq)("",!0)],64)))),128))])]),(0,a.Wm)(M,{pages:D.pagination,onEmitPages:O.getOrders},null,8,["pages","onEmitPages"]),(0,a.Wm)($,{order:D.orderDetail,ref:"orderModal",onUpdatePaid:O.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(x,{item:D.orderDetail,ref:"delOrderModal",onDelItem:O.delOrder},null,8,["item","onDelItem"])])])}var D=l(7964);const O={id:"productModal",ref:"Modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},v={class:"modal-dialog modal-xl"},M={class:"modal-content border-0"},$=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{id:"orderModalLabel",class:"modal-title"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),x={class:"modal-body"},z={class:"row"},C={class:"col-sm-4"},L=(0,a._)("h3",{class:"mb-3"},"顧客資料",-1),P={class:"table"},S={key:0},q=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),U=(0,a._)("th",null,"Email",-1),Z=(0,a._)("th",null,"電話",-1),E=(0,a._)("th",null,"地址",-1),H={class:"col-sm-8"},W=(0,a._)("h3",null,"訂單細節",-1),Y={class:"table"},A=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),K=(0,a._)("th",null,"下單時間",-1),V=(0,a._)("th",null,"付款時間",-1),I={key:0},N={key:1},j=(0,a._)("th",null,"付款狀態",-1),B={key:0,class:"text-success"},F={key:1,class:"text-muted"},G=(0,a._)("th",null,"總金額",-1),J=(0,a._)("h3",null,"選購商品",-1),Q={class:"table"},R=(0,a._)("thead",null,[(0,a._)("tr")],-1),T={class:"text-end"},X={class:"d-flex justify-content-end"},tt={class:"form-check"},et={class:"form-check-label",for:"flexCheckDefault"},lt={key:0},at={key:1},dt={class:"modal-footer"},it=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function st(t,e,l,s,r,n){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",v,[(0,a._)("div",M,[$,(0,a._)("div",x,[(0,a._)("div",z,[(0,a._)("div",C,[L,(0,a._)("table",P,[r.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",S,[(0,a._)("tr",null,[q,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.name),1)]),(0,a._)("tr",null,[U,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.email),1)]),(0,a._)("tr",null,[Z,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.tel),1)]),(0,a._)("tr",null,[E,(0,a._)("td",null,(0,d.zw)(r.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",H,[W,(0,a._)("table",Y,[(0,a._)("tbody",null,[(0,a._)("tr",null,[A,(0,a._)("td",null,(0,d.zw)(r.tempOrder.id),1)]),(0,a._)("tr",null,[K,(0,a._)("td",null,(0,d.zw)(t.$filters.date(r.tempOrder.create_at)),1)]),(0,a._)("tr",null,[V,(0,a._)("td",null,[r.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",I,(0,d.zw)(t.$filters.date(r.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",N,"時間不正確"))])]),(0,a._)("tr",null,[j,(0,a._)("td",null,[r.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",B,"已付款")):((0,a.wg)(),(0,a.iD)("span",F,"尚未付款"))])]),(0,a._)("tr",null,[G,(0,a._)("td",null,(0,d.zw)(t.$filters.currency(r.tempOrder.total)),1)])])]),J,(0,a._)("table",Q,[R,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(r.tempOrder.products,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",null,(0,d.zw)(e.product.title),1),(0,a._)("td",null,(0,d.zw)(e.qty)+" / "+(0,d.zw)(e.product.unit),1),(0,a._)("td",T,(0,d.zw)(t.$filters.currency(e.final_total)),1)])))),128))])]),(0,a._)("div",X,[(0,a._)("div",tt,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":e[0]||(e[0]=t=>r.tempOrder.is_paid=t)},null,512),[[i.e8,r.tempOrder.is_paid]]),(0,a._)("label",et,[r.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("span",lt,"已付款")):((0,a.wg)(),(0,a.iD)("span",at,"未付款"))])])])])])]),(0,a._)("div",dt,[it,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=e=>t.$emit("update-paid",r.tempOrder))},"修改付款狀態")])])])],512)}var rt=l(1339),nt={props:["order"],data(){return{status:{},tempOrder:{},isPaid:!1}},emits:["update-paid"],mixins:[rt.Z],watch:{order(){this.tempOrder=this.order}}},ot=l(89);const ut=(0,ot.Z)(nt,[["render",st]]);var ct=ut,pt=l(7393),ht={data(){return{isNew:!1,isLoading:!1,orders:{},orderDetail:{},pagination:{},currentPage:1}},components:{OrderModal:ct,DelModal:pt.Z,AdminPagination:D.Z},methods:{getOrders(t=1){this.currentPage=t,this.isLoading=!0,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/orders?page=${t}`).then((t=>{this.orders=t.data.orders,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(t,e){const l=this.$refs.orderModal;if("edit"===t)this.orderDetail={...e},this.isNew=!1,l.openModal();else if("delete"===t){this.orderDetail={...e};const t=this.$refs.delOrderModal;t.openModal()}},updatePaid(t){const e=`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/order/${t.id}`,l={is_paid:t.is_paid};this.isLoading=!0,this.$http.put(e,{data:l}).then((t=>{this.isLoading=!1;const e=this.$refs.orderModal;e.hideModal(),this.getOrders(this.currentPage),this.$httpMessageState(t,"更新付款狀態")})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))},delOrder(){const t=`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/order/${this.orderDetail.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1;const e=this.$refs.delOrderModal;e.hideModal(),this.getOrders(this.currentPage),this.$httpMessageState(t,"刪除訂單")})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"刪除訂單")}))}},created(){this.getOrders()}};const _t=(0,ot.Z)(ht,[["render",k]]);var mt=_t}}]);
//# sourceMappingURL=945.83a2109f.js.map
"use strict";(self["webpackChunkweek7"]=self["webpackChunkweek7"]||[]).push([[199],{1199:function(t,e,l){l.r(e),l.d(e,{default:function(){return ft}});var o=l(3396),a=l(7139);const i={id:"app"},s={class:"container"},d={class:"text-end mt-4"},r={class:"table mt-4"},c=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{width:"120"},"分類"),(0,o._)("th",null,"產品名稱"),(0,o._)("th",{width:"120"},"原價"),(0,o._)("th",{width:"120"},"售價"),(0,o._)("th",{width:"100"},"是否啟用"),(0,o._)("th",{width:"120"},"編輯")])],-1),n={class:"text-end"},u={class:"text-end"},p={key:0,class:"text-success"},m={key:1},h={class:"btn-group"},b=["onClick"],g=["onClick"];function _(t,e,l,_,f,w){const P=(0,o.up)("AdminLoading"),y=(0,o.up)("AdminPagination"),v=(0,o.up)("ProductModal"),D=(0,o.up)("DelModal");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",s,[(0,o.Wm)(P,{active:f.isLoading,"z-index":1060},null,8,["active"]),(0,o._)("div",d,[(0,o._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>w.openModal("new"))},"建立新的產品")]),(0,o._)("table",r,[c,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(f.products,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.id},[(0,o._)("td",null,(0,a.zw)(e.category),1),(0,o._)("td",null,(0,a.zw)(e.title),1),(0,o._)("td",n,(0,a.zw)(t.$filters.currency(e.origin_price)),1),(0,o._)("td",u,(0,a.zw)(t.$filters.currency(e.price)),1),(0,o._)("td",null,[e.is_enabled?((0,o.wg)(),(0,o.iD)("span",p,"啟用")):((0,o.wg)(),(0,o.iD)("span",m,"未啟用"))]),(0,o._)("td",null,[(0,o._)("div",h,[(0,o._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t=>w.openModal("edit",e)},"編輯",8,b),(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>w.openModal("delete",e)},"刪除",8,g)])])])))),128))])]),(0,o.Wm)(y,{pages:f.pagination,onEmitPages:w.getData},null,8,["pages","onEmitPages"]),(0,o.Wm)(v,{onUpdateProduct:w.updateProduct,product:f.productDetail,isNew:f.isNew,ref:"productModal"},null,8,["onUpdateProduct","product","isNew"]),(0,o.Wm)(D,{item:f.productDetail,ref:"delProductModal",onDelItem:w.delProduct},null,8,["item","onDelItem"])])])}var f=l(7964),w=l(9242);const P={id:"productModal",ref:"Modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},y={class:"modal-dialog modal-xl"},v={class:"modal-content border-0"},D={class:"modal-header bg-dark text-white"},k={id:"productModalLabel",class:"modal-title"},U={key:0},M={key:1},x=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$={class:"modal-body"},L={class:"row"},C={class:"col-sm-4"},V={class:"mb-3"},N=(0,o._)("label",{for:"imageUrl",class:"form-label"},"輸入主圖片網址",-1),z=["src"],A=(0,o._)("h3",{class:"mb-3"},"多圖新增",-1),S={key:0},Z={class:"mb-3"},W=(0,o._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),H=["onUpdate:modelValue"],Y=["src"],E={class:"col-sm-8"},I={class:"mb-3"},K=(0,o._)("label",{for:"title",class:"form-label"},"標題",-1),q={class:"row"},j={class:"mb-3 col-md-6"},B=(0,o._)("label",{for:"category",class:"form-label"},"分類",-1),F={class:"mb-3 col-md-6"},G=(0,o._)("label",{for:"price",class:"form-label"},"單位",-1),J={class:"row"},O={class:"mb-3 col-md-6"},Q=(0,o._)("label",{for:"origin_price",class:"form-label"},"原價",-1),R={class:"mb-3 col-md-6"},T=(0,o._)("label",{for:"price",class:"form-label"},"售價",-1),X=(0,o._)("hr",null,null,-1),tt={class:"mb-3"},et=(0,o._)("label",{for:"description",class:"form-label"},"產品描述",-1),lt={class:"mb-3"},ot=(0,o._)("label",{for:"content",class:"form-label"},"說明內容",-1),at={class:"mb-3"},it={class:"form-check"},st=(0,o._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),dt={class:"modal-footer"},rt=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function ct(t,e,l,a,i,s){return(0,o.wg)(),(0,o.iD)("div",P,[(0,o._)("div",y,[(0,o._)("div",v,[(0,o._)("div",D,[(0,o._)("h5",k,[l.isNew?((0,o.wg)(),(0,o.iD)("span",U,"新增產品")):((0,o.wg)(),(0,o.iD)("span",M,"編輯產品"))]),x]),(0,o._)("div",$,[(0,o._)("div",L,[(0,o._)("div",C,[(0,o._)("div",V,[N,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.tempProduct.imageUrl=t),type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,512),[[w.nr,i.tempProduct.imageUrl]]),(0,o._)("img",{class:"img-fluid",src:i.tempProduct.imageUrl,alt:""},null,8,z)]),A,Array.isArray(i.tempProduct.imagesUrl)?((0,o.wg)(),(0,o.iD)("div",S,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.tempProduct.imagesUrl,((t,e)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:e+"3345678"},[(0,o._)("div",Z,[W,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t=>i.tempProduct.imagesUrl[e]=t,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,H),[[w.nr,i.tempProduct.imagesUrl[e]]])]),(0,o._)("img",{class:"img-fluid",src:t},null,8,Y)],64)))),128)),!i.tempProduct.imagesUrl.length||i.tempProduct.imagesUrl[i.tempProduct.imagesUrl.length-1]?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=t=>i.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):((0,o.wg)(),(0,o.iD)("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=t=>i.tempProduct.imagesUrl.pop())}," 刪除圖片 "))])):(0,o.kq)("",!0)]),(0,o._)("div",E,[(0,o._)("div",I,[K,(0,o.wy)((0,o._)("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[3]||(e[3]=t=>i.tempProduct.title=t)},null,512),[[w.nr,i.tempProduct.title]])]),(0,o._)("div",q,[(0,o._)("div",j,[B,(0,o.wy)((0,o._)("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[4]||(e[4]=t=>i.tempProduct.category=t)},null,512),[[w.nr,i.tempProduct.category]])]),(0,o._)("div",F,[G,(0,o.wy)((0,o._)("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[5]||(e[5]=t=>i.tempProduct.unit=t)},null,512),[[w.nr,i.tempProduct.unit]])])]),(0,o._)("div",J,[(0,o._)("div",O,[Q,(0,o.wy)((0,o._)("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[6]||(e[6]=t=>i.tempProduct.origin_price=t)},null,512),[[w.nr,i.tempProduct.origin_price,void 0,{number:!0}]])]),(0,o._)("div",R,[T,(0,o.wy)((0,o._)("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[7]||(e[7]=t=>i.tempProduct.price=t)},null,512),[[w.nr,i.tempProduct.price,void 0,{number:!0}]])])]),X,(0,o._)("div",tt,[et,(0,o.wy)((0,o._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[8]||(e[8]=t=>i.tempProduct.description=t)},"\n                ",512),[[w.nr,i.tempProduct.description]])]),(0,o._)("div",lt,[ot,(0,o.wy)((0,o._)("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[9]||(e[9]=t=>i.tempProduct.content=t)},"\n                ",512),[[w.nr,i.tempProduct.content]])]),(0,o._)("div",at,[(0,o._)("div",it,[(0,o.wy)((0,o._)("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[10]||(e[10]=t=>i.tempProduct.is_enabled=t)},null,512),[[w.e8,i.tempProduct.is_enabled]]),st])])])])]),(0,o._)("div",dt,[rt,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=e=>t.$emit("update-product",i.tempProduct))},"確認")])])])],512)}var nt=l(1339),ut={props:["product","isNew"],data(){return{status:{},tempProduct:{}}},emits:["update-product"],mixins:[nt.Z],watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.tempProduct.imageUrl||(this.tempProduct.imageUrl="")}}},pt=l(89);const mt=(0,pt.Z)(ut,[["render",ct]]);var ht=mt,bt=l(7393),gt={data(){return{isNew:!1,isLoading:!1,products:[],productDetail:{},pagination:{},currentPage:1}},components:{ProductModal:ht,DelModal:bt.Z,AdminPagination:f.Z},methods:{getData(t=1){this.currentPage=t,this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/products?page=${t}`).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"錯誤訊息")}))},openModal(t,e){const l=this.$refs.productModal;if("new"===t)this.productDetail={},this.isNew=!0,l.openModal();else if("edit"===t)this.productDetail={...e},this.isNew=!1,l.openModal();else if("delete"===t){this.productDetail={...e};const t=this.$refs.delProductModal;t.openModal()}},updateProduct(t){let e="https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/product",l="post",o="新增產品";this.productDetail=t,this.isLoading=!0,this.isNew||(e=`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/product/${this.productDetail.id}`,l="put",o="更新產品");const a=this.$refs.productModal;this.$http[l](e,{data:this.productDetail}).then((t=>{this.isLoading=!1,this.$httpMessageState(t,o),a.hideModal(),this.getData(this.currentPage)})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.res,o)}))},delProduct(){const t=`https://vue3-course-api.hexschool.io/v2/api/cadiis/admin/product/${this.productDetail.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$httpMessageState(t,"刪除產品");const e=this.$refs.delProductModal;e.hideModal(),this.getData(this.currentPage)})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"刪除產品")}))}},created(){this.getData()}};const _t=(0,pt.Z)(gt,[["render",_]]);var ft=_t}}]);
//# sourceMappingURL=199.24b74be0.js.map